{% assign pc_margin_top = section.settings.pc_margin_top %}
{% assign pc_margin_bottom = section.settings.pc_margin_bottom %}


{% assign mobile_margin_top = section.settings.mobile_margin_top %}
{% assign mobile_margin_bottom = section.settings.mobile_margin_bottom %}
{% assign join_facebook_group_url = section.settings.join_facebook_group_url %}
{% assign join_facebook_group_title = section.settings.join_facebook_group_title %}
{% assign join_facebook_group_desc = section.settings.join_facebook_group_desc %}

<style>
  .face_book_button {
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      margin: {{pc_margin_top}}px auto {{pc_margin_bottom}}px auto;
  }

  .face_book_button h1 {
      font-size: 2vw;
      font-family: HarmonyOS_Sans_SC_Bold;
  }

  .face_book_button .desc {
      font-size: 1vw;
      color: #978C8C;
      line-height: 1.3;
      margin-top: 1.2em;
  }

  .face_book_button a {
      display: flex;
      align-items: center;
      justify-content: center;
      text-decoration: none;
      gap: 1vw;
      width: 11vw;
      height: 2.4vw;
      font-size: 1vw;
      border-radius: 36px;
      background-color: #0473FF;
      color: #fff;
      margin-top: 2vw;
  }

  .face_book_button a:hover {
      opacity: .8;
  }

  .face_book_button a svg {
      width: 1.2vw;
      height: 1.2vw;
  }

  @media (max-width: 960px) {
      .face_book_button {
        margin: {{pc_margin_top}} auto {{pc_margin_bottom}} auto;
      }
      .face_book_button h1 {
          font-size: 6.4vw;
      }

      .face_book_button .desc {
          font-size: 3.2vw;
      }

      .face_book_button a {
          gap: 2.4vw; 
          width: 32vw;
          height: 7.2vw;
          font-size: 3.2vw;
          margin-top: 6vw;
      }

      .face_book_button a svg {
          width: 3vw;
          height: 3vw;
      }

      .face_book_button .pc {
          display: none;
      }
  }
</style>

<div id="container-{{section.id}}" class="face_book_button">
  <h1>{{join_facebook_group_title}}</h1>
  <div class="desc">
    {{join_facebook_group_desc}}
  </div>
  <a
    class="join_facebook_group"
    href="{{join_facebook_group_url}}"
    target="_blank">
    <svg
      t="1690269851759"
      viewBox="0 0 1024 1024"
      version="1.1"
      xmlns="http://www.w3.org/2000/svg"
      p-id="6038"
      width="32"
      height="32">
      <path
        d="M512 512m-512 0a512 512 0 1 0 1024 0 512 512 0 1 0-1024 0Z"
        fill="#1B77F2"
        p-id="6039"></path>
      <path
        d="M1024 512c0-282.7776-229.2224-512-512-512S0 229.2224 0 512s229.2224 512 512 512 512-229.2224 512-512zM374.528 512V414.0032h60.0064V354.816c0-79.872 23.9104-137.472 111.4112-137.472h104.0384v97.7408h-73.216c-36.7616 0-45.056 24.3712-45.056 49.92v49.0496h112.896L629.248 512h-97.536v295.5264H434.5344V512H374.528z"
        fill="#FFFFFF"
        p-id="6040"></path>
    </svg>
    <span>Join Now</span>
  </a>
</div>


<script>
    const stationList = ['us', 'eu', 'uk', 'au', 'de', 'fr', 'it', 'es', 'jp', 'ca', 'kr', 'ru', 'br', 'mx', 'in', 'ae', 'sa', 'sg', 'id', 'th', 'vn', 'my', 'ph', 'nl', 'be', 'lu', 'pl', 'cz', 'sk', 'hu', 'at', 'ch', 'se', 'fi', 'no', 'dk', 'pt', 'ie', 'gr', 'ro', 'bg', 'hr', 'si', 'lt', 'lv', 'ee', 'mt', 'cy', 'tr', 'ua', 'by', 'rs', 'ba', 'mk', 'me', 'al', 'xk', 'md', 'kz', 'uz', 'tm', 'kg', 'tj', 'ge', 'am', 'az', 'mn', 'bn', 'lk', 'np', 'bd', 'pk', 'af', 'ir', 'iq', 'sy', 'lb', 'jo', 'ps', 'il', 'eg', 'ly', 'dz', 'ma', 'tn', 'sd', 'et', 'so', 'ke', 'ug', 'tz', 'rw', 'bi', 'mw', 'mz', 'mg', 'ls', 'bw', 'sz', 'na', 'za', 'gh', 'ci', 'ng', 'sn', 'gm', 'sl', 'lr']

    // const stationType = '';
     const stationType = 'shopify';
    const host = "https://bsplugins.creality.com";
    function getStation(stationType) {
        let station = ''
        let url = window.location.href;
        let urlObj = new URL(url);

        if (stationType === 'shopify') {
            // 获取主机名部分，并按'.'分割
            let hostParts = urlObj.hostname.split('.');
            // 获取第一个部分
            station = hostParts[0];
            if(station === 'www') {
                station = 'us'
            }
            station = 'shopify-' + station
        } else {
            // 获取路径部分，并按'/'分割
            let pathParts = urlObj.pathname.split('/').filter(part => part);
            // 获取第一个部分
            station = pathParts[0];
            if(!(stationList.includes(station))) {
                station = 'us';
            }
        }
        return station;
    }

    const stations = getStation(stationType);



    let url = '/openapi/dtc/activity/20240623/' + stations;

    let timer = null;
    $('.join_facebook_group').click(function () {
        if (!timer) {
            timer = true;
            $.ajax({
                url: host + url,
                type: 'POST',
                 headers: {
                    'value': '*'
                },
                success: function (res) {
                    // console.log(res);
                    // alert('count++')
                    console.log('count++')
                },
                error: function (err) {
                    // console.log(err);
                  // alert(JSON.stringify(err)) 
                },
                complete: function () {
                  
                    timer = null;
                }
            });
        }
    });

</script>

{% schema %}
  {
    "name": "join_facebook_button",
    "settings": [
      {
        "type": "text",
        "id": "join_facebook_group_url",
        "label": {
          "en-US": "join facebook group url",
          "zh-CN": "加入社群链接"
        },
        "default": "#"
      }, 
      {
        "type": "text",
        "id": "join_facebook_group_title",
        "label": {
          "en-US": "join facebook group title",
          "zh-CN": "加入社群标题"
        },
        "default": "Join Our Facebook Group"
      }, 
      {
        "type": "textarea",
        "id": "join_facebook_group_desc",
        "label": {
          "en-US": "join facebook group desc",
          "zh-CN": "加入社群描述"
        },
        "default": "Join the active Creality Falcon Facebook community, a vibrant hub for sharing ideas,<br class='pc'>discovering the latest updates, and engaging with real users."
      }, 
      {
        "type": "range",
        "id": "pc_margin_top",
        "label": {
          "en-US": "PC Margin top",
          "zh-CN": "PC 上间距"
        },
        "unit": "px",
        "step": 2,
        "min": 0,
        "max": 200,
        "default": 60
      },
      {
        "type": "range",
        "id": "pc_margin_bottom",
        "label": {
          "en-US": "PC Margin bottom",
          "zh-CN": "PC 下间距"
        },
        "unit": "px",
        "step": 2,
        "min": 0,
        "max": 200,
        "default": 60
      },
      {
        "type": "range",
        "id": "mobile_margin_top",
        "label": {
          "en-US": "Mobile Margin top",
          "zh-CN": "Mobile 上间距"
        },
        "unit": "px",
        "step": 2,
        "min": 0,
        "max": 200,
        "default": 30
      },
      {
        "type": "range",
        "id": "mobile_margin_bottom",
        "label": {
          "en-US": "Mobile Margin bottom",
          "zh-CN": "Mobile 下间距"
        },
        "unit": "px",
        "step": 2,
        "min": 0,
        "max": 200,
        "default": 30
      }
    ],
    "presets": [
      {
        "name": "join_facebook_button"
      }
    ]
  }
{% endschema %}