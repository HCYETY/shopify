<link rel="stylesheet" href="{{ 'reset.css' | asset_url }}">
{% for block in section.blocks %}
  {% if block.type == 'megamenu_style_6' %}
    {% style %}
      :root  {
        --fs: {{ block.settings.font_size }}px;
        --sizeBtn: {{ block.settings.item_btn_text_size }}px;
        --sizeCountDown: {{ block.settings.item_count_down_text_sieze }}px;
        --size-bg:100px
      }

      #shopify-section-{{ section.id }}-{{ block.id }} {
        top: 0;
        position: sticky;

        z-index: 999999;
      }
      .header-advertisement-{{ section.id }}-{{ block.id }} {
        background-color: {{ block.settings.item_bgcolor }};
        width: 100%;
        {% if block.settings.item_bgcolor_url %}
          background-image: url("{{block.settings.item_bgcolor_url}}");
        {% endif %}
        background-size: cover;
        /* 确保背景图像覆盖整个区域 */
      }

      .header-advertisement-{{ section.id }}-{{ block.id }}-box {
        display: flex;
        justify-content: {{ block.settings.item_position }};
        align-items: center;
        flex-wrap: wrap;
        width: 90%;
        margin: 0 auto;
        gap: calc(var(--fs) - 2px);
        padding: {{ block.settings.item_bgcolor_pd_tb }}px 0;
      }

      .header-advertisement-{{ section.id }}-{{ block.id }}-box-content {
        display: flex;
        align-items: center;
        gap: calc(var(--fs) - 2px);
      }

      .header-advertisement-{{ section.id }}-{{ block.id }}-box-content span:first-child {
        font-size: var(--fs);
        color: {{ block.settings.item_title_color }};
      }

      .header-advertisement-{{ section.id }}-{{ block.id }}-box-content span:nth-child(2) {
        padding: {{ block.settings.item_btn_pdtb_size }}px {{ block.settings.item_btn_pdlr_size }}px;
        margin-top: 1px;
        border-radius: {{ block.settings.item_btn_brr_size }}px;
        background-color: {{ block.settings.item_btn_bgcolor }};
        font-size: var(--sizeBtn);
        color: {{ block.settings.item_btn_color }};
        text-decoration: none;
        white-space: nowrap;
        cursor: pointer;
      }
      .header-advertisement-{{ section.id }}-{{ block.id }}-box-content span:nth-child(2):hover {
        opacity: 0.8;
      }
      {% if block.settings.is_countDown %}
        .header-advertisement-{{ section.id }}-{{ block.id }}-box-content span:last-child {
          font-size: var(--sizeCountDown);
          color: {{ block.settings.item_count_down_color }};
          font-weight: bold;
          white-space: nowrap;
        }
        .header-advertisement-{{ section.id }}-{{ block.id }}-box-content span:last-child i {
          font-weight: normal;
          opacity: 0.8;
          font-style: normal;
        }

      {% endif %}
      .header-advertisement-{{ section.id }}-Swiper {
          position: relative;
          overflow: hidden;

        }

        .header-advertisement-{{ section.id }}-Swiper-prev, .header-advertisement-{{ section.id }}-Swiper-next {
          cursor: pointer;
          position: absolute;
          top: 50%;
          transform: translateY(-50%) scale({{section.settings.item_rotatingBroadcast_size}});
          text-align: center;
          display: flex;
          justify-content: center;
          align-items: center;
          border-radius: 50%;
          width: 35px;
          height: 35px;
          z-index: 10;
          color: #fff;
        }

        .header-advertisement-{{ section.id }}-Swiper-prev:hover, .header-advertisement-{{ section.id }}-Swiper-next:hover {
          opacity: 0.7;
        }

        .header-advertisement-{{ section.id }}-Swiper-prev {
          left: var(--size-bg);
        }

        .header-advertisement-{{ section.id }}-Swiper-next {
          right: var(--size-bg);
        }
      @media screen and (max-width: 720px) {
        .header-advertisement-{{ section.id }}-{{ block.id }}-box-content {
          display: block;
          width: 95%;
          text-align: center;
        }
        .header-advertisement-{{ section.id }}-{{ block.id }}-box-content span {

          margin-right: calc(var(--fs) - 2px);
        }
        .header-advertisement-{{ section.id }}-{{ block.id }}-box-content span:first-child {
          line-height: calc(var(--fs) + 9px);
          font-size: calc(var(--fs) - 2px) !important;
        }
        .header-advertisement-{{ section.id }}-{{ block.id }}-box-content span:nth-child(2) {
          font-size: calc(var(--sizeBtn) - 2px) !important;
        }
        {% if section.settings.is_countDown %}
          .header-advertisement-{{ section.id }}-{{ block.id }}-box-content span:last-child {
            font-size: calc(var(--sizeCountDown) - 2px) !important;
          }
        {% endif %}
        .header-advertisement-{{ section.id }}-Swiper-prev {
            left: calc(var(--size-bg)/16);
          }
          .header-advertisement-{{ section.id }}-Swiper-next {
            right: calc(var(--size-bg)/16);
          }
      }
    {% endstyle %}
  {% endif %}
{% endfor %}

<div class="header-advertisement-{{ section.id }}-Swiper">
  <div class="swiper-wrapper">
    {% for block in section.blocks %}
      {% if block.type == 'megamenu_style_6' %}
        <div class="swiper-slide">
          <div class="header-advertisement-{{section.id}}-{{ block.id }}">
            <div class="header-advertisement-{{ section.id }}-{{ block.id }}-box">
              <div class="header-advertisement-{{ section.id }}-{{ block.id }}-box-content">
                <span>{{ block.settings.item_title }}</span>
                {% if block.settings.item_btn_text != blank %}
                  <span onclick="window.open('{{ block.settings.item_btn_url }}', '_blank')">
                    {{- block.settings.item_btn_text -}}
                  </span>
                {% endif %}
                {% if block.settings.is_countDown %}
                  <span
                    id="activityText-{{section.id}}-{{ block.id }}"
                    class="header-advertisement-{{ section.id }}-{{ block.id }}-box-countDown"
                  ></span>
                {% endif %}
              </div>
            </div>
          </div>
        </div>
      {% endif %}
    {% endfor %}
  </div>
  <!-- 如果需要导航按钮 -->
  {% if section.settings.is_rotatingBroadcast_md %}
    <div class="header-advertisement-{{ section.id }}-Swiper-prev">
      <svg class="" width="12" height="16" viewBox="0 0 12 16" xmlns="http://www.w3.org/2000/svg">
        <path
          d="m9.131 15.263 1.132-1.132-6-6 6-6L9.13 1 2 8.131l7.131 7.132z"
          fill="{{section.settings.item_rotatingBroadcast_color_md}}"
          stroke="{{section.settings.item_rotatingBroadcast_color_md}}"
          stroke-width="1"
        ></path>
      </svg>
    </div>
    <div class="header-advertisement-{{ section.id }}-Swiper-next">
      <svg class="" width="12" height="16" viewBox="0 0 12 16" xmlns="http://www.w3.org/2000/svg">
        <path
          d="M3.131 15.263 2 14.13l6-6-6-6L3.131 1l7.132 7.131-7.132 7.132z"
          fill="{{section.settings.item_rotatingBroadcast_color_md}}"
          stroke="{{section.settings.item_rotatingBroadcast_color_md}}"
          stroke-width="1"
        ></path>
      </svg>
    </div>
  {% endif %}
</div>
<script>
                     {% for block in section.blocks %}
                        {% if block.type =="megamenu_style_6" %}
                    $(function () {
                  {% assign start_time_iso = block.settings.item_count_down_start | date: "%Y-%m-%dT%H:%M:%S" %}
                  {% assign end_time_iso = block.settings.item_count_down_end | date: "%Y-%m-%dT%H:%M:%S" %}
                  
                    countDown();
                  function countDown() {
                    const $activityText = $("#activityText-{{section.id}}-{{ block.id }}");
                    const startTime = new Date("{{start_time_iso}}");
                    const endTime = new Date("{{end_time_iso}}");
                    const nowTime = new Date();
                    const beginDiff = Math.floor((startTime - nowTime) / 1000);
                    const endDiff = Math.floor((endTime - nowTime) / 1000);
                    const leftTime = beginDiff > 0 ? beginDiff : endDiff;
              
                    let day = Math.floor(leftTime / (24 * 60 * 60));
                    let hour = Math.floor((leftTime / (60 * 60)) % 24);
                    let minute = Math.floor((leftTime / 60) % 60);
                    let second = Math.floor(leftTime % 60);
              
                    day = addZero(day);
                    hour = addZero(hour);
                    minute = addZero(minute);
                    second = addZero(second);
              
                    if (beginDiff > 0) {
                      $activityText.html(
                        `${day}<i>d：</i>${hour}<i>h：</i>${minute}<i>m：</i>${second}<i>s</i>`
                      );
                      setTimeout(countDown, 1000);
                    } else if (leftTime <= 0) {
                      $activityText.text("theEventHasEnded！");
                    } else {
                      $activityText.html(
                        `${day}<i>d：</i>${hour}<i>h：</i>${minute}<i>m：</i>${second}<i>s</i>`
                      );
                      setTimeout(countDown, 1000);
                    }
                  }
                  function addZero(i) {
                    return i < 10 ? "0" + i : i;
                  }
                    });
                {% endif %}
            {% endfor %}
            {% if section.settings.is_rotatingBroadcast_md %}
                $(function () {
              var swiper = new Swiper(".header-advertisement-{{ section.id }}-Swiper", {
                 slidesPerView: 1,
                  loopFillGroupWithBlank: true,
                  loopAdditionalSlides: 5,
                  loop: true,
                   autoplay: {
                     delay: 3500, // 设置自动播放的间隔时间，单位是毫秒（这里是3秒）
                       disableOnInteraction: false,
                   },
                 });
                 $(".header-advertisement-{{ section.id }}-Swiper-prev").on("click", function (e) {
                   e.preventDefault();
                   swiper.slidePrev();
                 });        
                 $(".header-advertisement-{{ section.id }}-Swiper-next").on("click", function (e) {
                   e.preventDefault();
                   swiper.slideNext();
                 });
           });
            {% endif %}
</script>
{% schema %}
{
  "name": "header_advertisement",
  "settings": [
   {
                "type": "range",
                "id": "item_rotatingBroadcast_size_md",
                "label": "轮播按钮大小",
                "min": 0,
                "max": 10,
                "step": 1,
                "unit": "px",
                "default": 1
              },
              {
                "type": "checkbox",
                "id": "is_rotatingBroadcast_md",
                "label": "是否启用轮播",
                "default": false
              }
  ],
  "blocks": [
      {
            "type": "megamenu_style_6",
            "name":"header_advertisement",
            "settings": [
              {
                "type": "color",
                "id": "item_bgcolor",
                "label": "背景颜色",
                "default": "#000"
              },
              {
                "type": "text",
                "id": "item_bgcolor_url",
                "label": "背景图片(有背景图片则不显示背景色)"
              },
              {
                "type": "range",
                "id": "font_size",
                "label": "文字大小",
                "min": 0,
                "max": 50,
                "step": 1,
                "unit": "px",
                "default": 14
              },
              {
                "type": "range",
                "id": "item_bgcolor_pd_tb",
                "label": "背景上下内边距",
                "min": 0,
                "max": 50,
                "step": 1,
                "unit": "px",
                "default": 12
              }, {
                "type": "text",
                "id": "item_title",
                "label": "文案标题",
                "default": "🎉 Summer- Last Call! Falcon2 Pro Up to 35% Off✨"
              }, {
                "type": "color",
                "id": "item_title_color",
                "label": "文案标题颜色",
                "default": "#ddaf30"
              }, {
                "type": "text",
                "id": "item_btn_text",
                "label": "按钮文案",
                "default": "SHOP NOW"
              }, {
                "type": "text",
                "id": "item_btn_url",
                "label": "按钮超链接",
                "default": "baidu.com"
              }, {
                "type": "color",
                "id": "item_btn_color",
                "label": "按钮文字颜色",
                "default": "#FFF"
              }, {
                "type": "color",
                "id": "item_btn_bgcolor",
                "label": "按钮背景颜色",
                "default": "#FF0000 "
              }, {
                "type": "range",
                "id": "item_btn_brr_size",
                "label": "按钮圆角",
                "min": 0,
                "max": 50,
                "step": 1,
                "unit": "px",
                "default": 3
              }, {
                "type": "range",
                "id": "item_btn_pdlr_size",
                "label": "按钮左右边距",
                "min": 0,
                "max": 50,
                "step": 1,
                "unit": "px",
                "default": 12
              }, {
                "type": "range",
                "id": "item_btn_pdtb_size",
                "label": "按钮上下边距",
                "min": 0,
                "max": 50,
                "step": 1,
                "unit": "px",
                "default": 4
              }, {
                "type": "range",
                "id": "item_btn_text_size",
                "label": "按钮文字大小",
                "min": 0,
                "max": 50,
                "step": 1,
                "unit": "px",
                "default": 12
              }, {
                "type": "select",
                "id": "item_position",
                "label": "文案位置",
                "options": [
                  {
                    "value": "let",
                    "label": "Let"
                  }, {
                    "value": "center",
                    "label": "Center"
                  }, {
                    "value": "right",
                    "label": "Right"
                  }
                ],
                "default": "center"
              }, {
                "type": "checkbox",
                "id": "is_countDown",
                "label": "是否使用倒计时",
                "default": false
              }, {
                "type": "text",
                "id": "item_count_down_start",
                "label": "倒计时开始时间",
                "default": "2024-8-28 00:00:00"
              }, {
                "type": "text",
                "id": "item_count_down_end",
                "label": "倒计时结束时间",
                "default": "2024-8-29 23:59:59"
              }, {
                "type": "color",
                "id": "item_count_down_color",
                "label": "倒计时颜色",
                "default": "#FFF "
              }, {
                "type": "range",
                "id": "item_count_down_text_sieze",
                "label": "倒计时文字大小",
                "min": 0,
                "max": 50,
                "step": 1,
                "unit": "px",
                "default": 12
              }
            ]
        }
  ],
  "presets": [
    {
      "name": "header_advertisement"
    }
  ]
}
{% endschema %}
